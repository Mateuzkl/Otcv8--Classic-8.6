letterWidth = {
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	1,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	nil,
	1,
	3,
	6,
	8,
	7,
	13,
	9,
	3,
	5,
	5,
	6,
	8,
	4,
	5,
	3,
	8,
	7,
	6,
	7,
	7,
	7,
	7,
	7,
	7,
	7,
	7,
	3,
	4,
	8,
	8,
	8,
	6,
	10,
	9,
	7,
	7,
	8,
	7,
	7,
	8,
	8,
	5,
	5,
	7,
	7,
	9,
	8,
	8,
	7,
	8,
	8,
	7,
	8,
	8,
	8,
	12,
	8,
	8,
	7,
	5,
	8,
	5,
	9,
	8,
	5,
	7,
	7,
	6,
	7,
	7,
	5,
	7,
	7,
	3,
	4,
	7,
	3,
	11,
	7,
	7,
	7,
	7,
	6,
	6,
	5,
	7,
	8,
	10,
	8,
	8,
	6,
	7,
	4,
	7,
	8,
	1,
	7,
	6,
	3,
	7,
	6,
	11,
	7,
	7,
	7,
	13,
	7,
	4,
	11,
	6,
	6,
	6,
	6,
	4,
	3,
	7,
	6,
	6,
	7,
	10,
	7,
	10,
	6,
	5,
	11,
	6,
	6,
	8,
	4,
	3,
	7,
	7,
	7,
	8,
	4,
	7,
	6,
	10,
	6,
	8,
	8,
	16,
	10,
	8,
	5,
	8,
	5,
	5,
	6,
	7,
	7,
	3,
	5,
	6,
	6,
	8,
	12,
	12,
	12,
	6,
	9,
	9,
	9,
	9,
	9,
	9,
	11,
	7,
	7,
	7,
	7,
	7,
	5,
	5,
	6,
	5,
	8,
	8,
	8,
	8,
	8,
	8,
	8,
	8,
	8,
	8,
	8,
	8,
	8,
	8,
	7,
	7,
	7,
	7,
	7,
	7,
	7,
	7,
	11,
	6,
	7,
	7,
	7,
	7,
	3,
	4,
	4,
	4,
	7,
	7,
	7,
	7,
	7,
	7,
	7,
	9,
	7,
	7,
	7,
	7,
	7,
	8,
	7,
	8
}
local messageModeCallbacks = {}

function g_game.onTextMessage(messageMode, message)
	local callbacks = messageModeCallbacks[messageMode]

	if not callbacks or #callbacks == 0 then
		perror(string.format("Unhandled onTextMessage message mode %i: %s", messageMode, message))

		return
	end

	for _, callback in pairs(callbacks) do
		callback(messageMode, message)
	end
end

function registerMessageMode(messageMode, callback)
	if not messageModeCallbacks[messageMode] then
		messageModeCallbacks[messageMode] = {}
	end

	table.insert(messageModeCallbacks[messageMode], callback)

	return true
end

function unregisterMessageMode(messageMode, callback)
	if not messageModeCallbacks[messageMode] then
		return false
	end

	return table.removevalue(messageModeCallbacks[messageMode], callback)
end
